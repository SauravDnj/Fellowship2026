<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agricultural & Climate Data Q&A System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #e8f5e9 0%, #e3f2fd 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .header h1 {
            color: #2e7d32;
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 16px;
        }
        
        .data-sources {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .source-badge {
            background: #4caf50;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .source-badge.climate {
            background: #2196f3;
        }
        
        .search-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .search-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            display: block;
        }
        
        .search-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        #questionInput {
            flex: 1;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        #questionInput:focus {
            outline: none;
            border-color: #4caf50;
        }
        
        #searchBtn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        #searchBtn:hover {
            background: #45a049;
        }
        
        #searchBtn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .sample-questions {
            margin-top: 20px;
        }
        
        .sample-questions p {
            font-weight: 600;
            color: #666;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .sample-btn {
            background: #f5f5f5;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            margin: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        
        .sample-btn:hover {
            background: #e0e0e0;
        }
        
        .results-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: none;
        }
        
        .results-section.active {
            display: block;
        }
        
        .answer-box {
            background: #f9f9f9;
            border-left: 4px solid #4caf50;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .answer-box pre {
            white-space: pre-wrap;
            font-family: 'Segoe UI', sans-serif;
            color: #333;
            line-height: 1.6;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .data-table th {
            background: #4caf50;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        
        .data-table td {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .data-table tr:hover {
            background: #f5f5f5;
        }
        
        .sources-list {
            margin-top: 20px;
            padding: 20px;
            background: #e3f2fd;
            border-radius: 8px;
        }
        
        .sources-list h3 {
            color: #1976d2;
            margin-bottom: 10px;
        }
        
        .sources-list li {
            color: #555;
            margin: 8px 0;
            line-height: 1.5;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4caf50;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üåæ Agricultural & Climate Data Q&A System</h1>
            <p>Integrating data.gov.in sources for intelligent insights</p>
            <div class="data-sources">
                <span class="source-badge">üìä Ministry of Agriculture & Farmers Welfare</span>
                <span class="source-badge climate">üå¶Ô∏è India Meteorological Department</span>
            </div>
        </div>

        <!-- Search Section -->
        <div class="search-section">
            <label class="search-label">Ask a Question</label>
            <div class="search-container">
                <input 
                    type="text" 
                    id="questionInput" 
                    placeholder="e.g., Compare rainfall in Maharashtra and Punjab for the last 4 years..."
                />
                <button id="searchBtn">Search</button>
            </div>

            <div class="sample-questions">
                <p>Sample Questions:</p>
                <button class="sample-btn" onclick="askQuestion('Compare rainfall in Maharashtra and Punjab for last 4 years')">
                    Compare rainfall in Maharashtra and Punjab
                </button>
                <button class="sample-btn" onclick="askQuestion('Top 3 crops in Maharashtra by production')">
                    Top 3 crops in Maharashtra
                </button>
                <button class="sample-btn" onclick="askQuestion('Which district has highest Rice production in Maharashtra?')">
                    Highest Rice production district
                </button>
                <button class="sample-btn" onclick="askQuestion('Production trend of Wheat in Punjab')">
                    Wheat production trend
                </button>
            </div>
        </div>

        <!-- Loading -->
        <div id="loading" class="loading" style="display: none;">
            <div class="spinner"></div>
            <p>Processing your question...</p>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="results-section">
            <h2>‚úÖ Answer</h2>
            <div class="answer-box">
                <pre id="answerText"></pre>
            </div>

            <div id="dataSection" style="display: none;">
                <h3>üìà Data Summary</h3>
                <div id="dataContent"></div>
            </div>

            <div class="sources-list">
                <h3>üìö Data Sources</h3>
                <ul id="sourcesList"></ul>
            </div>
        </div>
    </div>

    <script>
        // Simulated backend data (in production, this would call the Python Flask API)
        const agriculturalData = {
            'Maharashtra': {
                'crops': {
                    'Rice': { 2020: 3500, 2021: 3650, 2022: 3800, 2023: 3900 },
                    'Wheat': { 2020: 2100, 2021: 2200, 2022: 2250, 2023: 2300 },
                    'Cotton': { 2020: 8500, 2021: 8700, 2022: 8900, 2023: 9100 }
                },
                'districts': {
                    'Nashik': { 'Rice': 450, 'Wheat': 320 },
                    'Pune': { 'Rice': 380, 'Wheat': 280 },
                    'Nagpur': { 'Rice': 520, 'Wheat': 250 }
                },
                'rainfall': { 2020: 1150, 2021: 1200, 2022: 1100, 2023: 1250 }
            },
            'Punjab': {
                'crops': {
                    'Rice': { 2020: 4200, 2021: 4300, 2022: 4400, 2023: 4500 },
                    'Wheat': { 2020: 5100, 2021: 5200, 2022: 5300, 2023: 5400 },
                    'Cotton': { 2020: 1200, 2021: 1250, 2022: 1300, 2023: 1350 }
                },
                'districts': {
                    'Ludhiana': { 'Rice': 680, 'Wheat': 850 },
                    'Amritsar': { 'Rice': 620, 'Wheat': 780 }
                },
                'rainfall': { 2020: 650, 2021: 700, 2022: 680, 2023: 720 }
            }
        };

        document.getElementById('searchBtn').addEventListener('click', () => {
            const question = document.getElementById('questionInput').value;
            if (question.trim()) {
                processQuestion(question);
            }
        });

        document.getElementById('questionInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const question = document.getElementById('questionInput').value;
                if (question.trim()) {
                    processQuestion(question);
                }
            }
        });

        function askQuestion(question) {
            document.getElementById('questionInput').value = question;
            processQuestion(question);
        }

        function processQuestion(question) {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('resultsSection').classList.remove('active');
            document.getElementById('searchBtn').disabled = true;

            setTimeout(() => {
                const result = analyzeQuestion(question);
                displayResults(result);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('searchBtn').disabled = false;
            }, 1500);
        }

        function analyzeQuestion(question) {
            const q = question.toLowerCase();
            
            // Compare rainfall
            if (q.includes('rainfall') && q.includes('compare')) {
                const states = ['Maharashtra', 'Punjab'].filter(s => q.includes(s.toLowerCase()));
                if (states.length >= 2) {
                    return compareRainfall(states);
                }
            }
            
            // Top crops
            if (q.includes('top') && q.includes('crop')) {
                const state = Object.keys(agriculturalData).find(s => q.includes(s.toLowerCase()));
                if (state) {
                    return getTopCrops(state);
                }
            }
            
            // District analysis
            if (q.includes('district') && q.includes('highest')) {
                const state = Object.keys(agriculturalData).find(s => q.includes(s.toLowerCase()));
                const crop = ['Rice', 'Wheat', 'Cotton'].find(c => q.includes(c.toLowerCase()));
                if (state && crop) {
                    return analyzeDistricts(state, crop);
                }
            }
            
            // Production trend
            if (q.includes('trend') || q.includes('production')) {
                const state = Object.keys(agriculturalData).find(s => q.includes(s.toLowerCase()));
                const crop = ['Rice', 'Wheat', 'Cotton'].find(c => q.includes(c.toLowerCase()));
                if (state && crop) {
                    return analyzeTrend(state, crop);
                }
            }
            
            return {
                answer: "I couldn't find data matching your query. Please try one of the sample questions.",
                sources: ['No matching data sources'],
                data: null
            };
        }

        function compareRainfall(states) {
            const years = [2020, 2021, 2022, 2023];
            const comparison = {};
            
            states.forEach(state => {
                const rainfall = agriculturalData[state].rainfall;
                const avg = Object.values(rainfall).reduce((a, b) => a + b) / years.length;
                comparison[state] = { average: avg, yearly: rainfall };
            });
            
            let answer = `Rainfall Comparison (2020-2023):\n\n`;
            Object.entries(comparison).forEach(([state, data]) => {
                answer += `${state}: Average ${data.average.toFixed(0)}mm per year\n`;
            });
            
            return {
                answer,
                sources: [
                    'India Meteorological Department - Rainfall Statistics 2020-2023',
                    'data.gov.in/rainfall_india'
                ],
                data: comparison
            };
        }

        function getTopCrops(state) {
            const crops = agriculturalData[state].crops;
            const cropArray = Object.entries(crops).map(([name, years]) => ({
                name,
                production: years[2023]
            })).sort((a, b) => b.production - a.production);
            
            let answer = `Top crops in ${state} (2023 production in '000 tonnes):\n\n`;
            cropArray.forEach((crop, i) => {
                answer += `${i + 1}. ${crop.name}: ${crop.production.toLocaleString()}\n`;
            });
            
            return {
                answer,
                sources: [
                    'Ministry of Agriculture & Farmers Welfare - Crop Production Statistics 2023',
                    'data.gov.in/agricultural_statistics'
                ],
                data: cropArray
            };
        }

        function analyzeDistricts(state, crop) {
            const districts = agriculturalData[state].districts;
            const districtArray = Object.entries(districts)
                .filter(([_, crops]) => crops[crop])
                .map(([name, crops]) => ({ district: name, production: crops[crop] }))
                .sort((a, b) => b.production - a.production);
            
            let answer = `${crop} production by district in ${state} (2023):\n\n`;
            districtArray.forEach((d, i) => {
                answer += `${i + 1}. ${d.district}: ${d.production.toLocaleString()} ('000 tonnes)\n`;
            });
            answer += `\nHighest: ${districtArray[0].district}`;
            
            return {
                answer,
                sources: [
                    'Ministry of Agriculture - District-wise Production 2023',
                    'data.gov.in/district_agriculture_data'
                ],
                data: districtArray
            };
        }

        function analyzeTrend(state, crop) {
            const cropData = agriculturalData[state].crops[crop];
            const years = Object.keys(cropData).map(Number);
            const productions = Object.values(cropData);
            const growth = ((productions[3] - productions[0]) / productions[0] * 100).toFixed(1);
            
            let answer = `${crop} production trend in ${state}:\n\n`;
            years.forEach((year, i) => {
                answer += `${year}: ${productions[i].toLocaleString()} ('000 tonnes)\n`;
            });
            answer += `\nOverall growth: ${growth}%`;
            
            return {
                answer,
                sources: [
                    'Ministry of Agriculture - Historical Production Data',
                    'data.gov.in/crop_statistics_timeseries'
                ],
                data: { years, productions, growth }
            };
        }

        function displayResults(result) {
            document.getElementById('answerText').textContent = result.answer;
            
            const sourcesList = document.getElementById('sourcesList');
            sourcesList.innerHTML = '';
            result.sources.forEach(source => {
                const li = document.createElement('li');
                li.textContent = source;
                sourcesList.appendChild(li);
            });
            
            document.getElementById('resultsSection').classList.add('active');
        }
    </script>
</body>
</html>